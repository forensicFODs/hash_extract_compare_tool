# hash_extract_compare_tool

# 포렌식 해시 무결성 검증 도구 - 사용자 매뉴얼

## 🎯 이 도구는 무엇인가요?

파일의 무결성(변조 여부)을 검증하는 포렌식 도구

- 📸 **베이스라인**: 원본 상태의 파일 해시를 기록
- 🔍 **검증**: 나중에 다시 검사해서 변조/삭제/추가된 파일 탐지
- 📊 **리포트**: 변경 사항을 자세한 보고서로 출력

Flow Chart

<aside>

![Flow 차트.png](attachment:6dd4a218-fc55-4940-ace6-bf386fe629e5:Flow_차트.png)

</aside>

---

## 🚀 빠른 시작 가이드

### **Step 1: 처음 사용 - 베이스라인 생성**

증거물을 압수하거나 중요 파일을 보호하고 싶을 때 **가장 먼저** 해야 할 일

```bash
python forensic_hash_tool.py
```

**실행 후:**

```
검사할 폴더 경로를 입력하세요: C:\evidence\case001

🔍 베이스라인 자동 탐지 중...
✗ 베이스라인을 발견하지 못했습니다.

다음 중 선택하세요:
1) 베이스라인 생성 (최초 해시 기록)  ← 이거 선택!
2) 기존 베이스라인 파일 지정
3) 베이스라인 없이 해시만 추출

선택 [1]: 1
```

**결과:**

- `baseline_case001_20250120_103045.txt` 파일 생성
- ⚠️ **이 파일을 안전하게 보관하세요!** (USB, 별도 저장소 등)

---

### **Step 2: 나중에 검증 - 무결성 확인**

나중에 파일이 변조되었는지 확인하고 싶을 때:

```bash
python forensic_hash_tool.py
```

**실행 후:**

```
검사할 폴더 경로를 입력하세요: C:\evidence\case001

🔍 베이스라인 자동 탐지 중...
✓ 1개의 베이스라인을 발견했습니다:

1) baseline_case001_20250115_103045.txt
   생성: 2025-01-15 10:30:45 (5일 전) ⭐ 최신
   대상: C:\evidence\case001 ✓
   파일: 156개

다음 중 선택하세요:
1) 베이스라인과 비교 (무결성 검증)  ← 이거 선택!
2) 새 베이스라인 생성
3) 다른 베이스라인 파일 지정
4) 베이스라인 없이 해시만 추출

선택 [1]: 1

```

**결과:**

- 변조/삭제/추가된 파일 자동 탐지
- `integrity_report_20250120_153000.txt` 리포트 생성

---

## 📖 상세 사용 방법

### **방법 1: 대화형 모드**

```bash
python forensic_hash_tool.py
```

---

### **방법 2: 명령어 모드** (빠른 작업용)

### **베이스라인 생성**

```bash
python forensic_hash_tool.py --create C:\evidence\case00
```

### **자동 검증** (베이스라인 자동 찾기)

```bash
python forensic_hash_tool.py --auto C:\evidence\case001
```

### **수동 검증** (베이스라인 파일 직접 지정)

```bash
python forensic_hash_tool.py --verify C:\evidence\case001 --baseline baseline.txt
```

### **도움말**

```bash
python forensic_hash_tool.py --help

```

---

## 🔍 검증 결과 이해하기

### **화면 출력 예시:**

```
🔐 무결성 검증 리포트
================================================================================
베이스라인 생성: 2025-01-15 10:30:45
검증 시간: 2025-01-20 15:30:00
================================================================================

📊 요약:
  총 파일 수: 158개
  ✅ 변경 없음: 153개
  ⚠️  변조됨: 2개
  ❌ 삭제됨: 1개
  🆕 추가됨: 2개

```

### **항목별 의미:**

| 항목 | 의미 | 중요도 |
| --- | --- | --- |
| ✅ **변경 없음** | 베이스라인과 완전히 동일 | 정상 |
| ⚠️ **변조됨** | 파일 내용이 수정됨 | 🚨 **경고** |
| ❌ **삭제됨** | 원본에 있던 파일이 사라짐 | 🚨 **경고** |
| 🆕 **추가됨** | 새로운 파일 생김 | ⚠️ 확인 필요 |

---

## 📁 생성되는 파일들

```
C:\evidence\case001\
├── baseline_case001_20250115_103045.txt    ← 베이스라인 (원본 기록)
├── integrity_report_20250120_153000.txt    ← 검증 리포트
└── [검사 대상 파일들...]

```

### **베이스라인 파일 (`baseline_*.txt`)**

- 원본 상태의 모든 파일 해시 기록
- 이 파일이 변조되면 검증 의미 없음
- **반드시 안전한 곳에 백업 보관**

### **검증 리포트 (`integrity_report_*.txt`)**

- 검증 결과 상세 내역
- 법정 제출용 증거 자료로 활용 가능
- 변조/삭제/추가된 파일 목록 + 해시 값 포함

---

## 💡 실무 활용 시나리오

### **시나리오 1: 디지털 증거 보전**

```
1. 증거 압수 직후
   → python forensic_hash_tool.py --create C:\evidence\case001
   → baseline.txt 생성 → USB에 백업

2. 분석 작업 중 (3일 후)
   → 혹시 파일이 바뀌었나 의심
   → python forensic_hash_tool.py --auto C:\evidence\case001

3. 결과 확인
   → "✅ 무결성 검증 통과" → 안심하고 분석 계속
   → "⚠️ 변조 발견" → 체인 오브 커스터디 문제 발생

```

---

### **시나리오 2: 중요 파일 보호**

```
1. 회사 중요 문서 폴더 스캔
   → python forensic_hash_tool.py --create D:\confidential

2. 주기적으로 검증 (매주 월요일)
   → python forensic_hash_tool.py --auto D:\confidential

3. 변조 발견 시
   → 누가, 언제 수정했는지 추적
   → 리포트를 보안팀에 제출

```

---

### **시나리오 3: 악성 코드 감염 확인**

```
1. 정상 상태에서 베이스라인 생성
   → python forensic_hash_tool.py --create C:\Windows\System32

2. 의심스러운 활동 발견 후 검증
   → python forensic_hash_tool.py --auto C:\Windows\System32

3. 결과 분석
   → 🆕 추가된 .dll 파일 → 악성 코드 의심
   → ⚠️ 변조된 시스템 파일 → 루트킷 가능성

```

---

## ⚠️ 주의사항

### ❗ **베이스라인 파일 보관**

- 베이스라인 파일 자체가 변조되면 검증 불가능
- **외부 USB, 클라우드, 별도 서버**에 백업 보관
- 가능하면 **쓰기 보호**된 매체에 저장

### ❗ **검사 대상 폴더**

- 하드디스크 전체를 스캔하면 시간이 오래 걸림
- 필요한 폴더만 지정하는 것을 추천
- 예: `C:\evidence\case001` (전체 C:\ 말고)

### ❗ **실시간 변경되는 파일**

- 로그 파일, 임시 파일은 계속 변경됨
- 이런 파일은 당연히 "변조됨"으로 표시
- 필요하면 제외하거나 별도 관리

### ❗ **시간 동기화**

- 베이스라인 생성 시간이 중요
- 컴퓨터 시계가 정확한지 확인
- 타임존 차이도 고려

---

## 🆘 자주 묻는 질문 (FAQ)

### **Q1: 베이스라인을 여러 개 만들어도 되나요?**

**A:** 여러 시점의 베이스라인을 만들 수 있음

- 최초 압수 시: `baseline_case001_20250115.txt`
- 1차 분석 후: `baseline_case001_20250118.txt`
- 2차 분석 후: `baseline_case001_20250120.txt`

프로그램이 자동으로 최신 것을 우선 표시

---

### **Q2: 베이스라인 파일은 어디에 저장되나요?**

**A:** 검사한 폴더 안에 자동 저장

- 검사 폴더: `C:\evidence\case001`
- 저장 위치: `C:\evidence\case001\baseline_case001_20250115.txt`

다른 곳에 백업하는 것을 강력히 권장

---

### **Q3: 해시가 뭔가요?**

**A:** 파일의 "디지털 지문"입니다.

- 파일 내용이 1비트라도 바뀌면 해시 값도 완전히 달라짐
- SHA256 알고리즘 사용 (보안성 매우 높음)
- 예: `a1b2c3d4e5f6789...` (64자리 16진수)

---

### **Q4: 검증에 시간이 얼마나 걸리나요?**

**A:** 파일 개수와 크기에 따라 다름

- 100개 파일 (1GB): 약 30초
- 1,000개 파일 (10GB): 약 5분
- 10,000개 파일 (100GB): 약 30분

대용량 파일이 많으면 더 오래 걸림

---

### **Q5: 실수로 베이스라인을 삭제했어요!**

**A:** 복구 불가능

- 베이스라인 = 원본 기록의 유일한 사본
- 새로 베이스라인을 만들어야 합니다
- **항상 백업 보관**

---

### **Q6: 하위 폴더도 같이 검사되나요?**

**A:** 기본적으로 모든 하위 폴더를 포함

```
C:\evidence\case001\
├── documents\
│   ├── file1.pdf      ← 검사 O
│   └── file2.docx     ← 검사 O
└── images\
    └── photo.jpg      ← 검사 O
```

---

### **Q7: 다른 컴퓨터에서도 검증 가능한가요?**

**A:** 가능

1. 베이스라인 파일 (`baseline_*.txt`)을 복사
2. 다른 컴퓨터에서 이 프로그램 실행
3. "다른 베이스라인 파일 지정" 선택
4. 복사한 베이스라인으로 검증

단, 폴더 경로가 달라도 파일 구조는 같아야 함

---

### **Q8: 리포트를 인쇄할 수 있나요?**

**A:** `integrity_report_*.txt` 파일을 열어서 인쇄하면 됨

- 메모장, 워드패드 등으로 열기
- PDF로 변환 가능
- 법정 제출용으로도 사용 가능

---

### **Q9: 에러가 발생하면 어떻게 하나요?**

**A:** 다음을 확인하세요:

1. Python 3.6 이상 설치되어 있는지
2. 폴더 경로가 정확한지 (띄어쓰기, 특수문자 확인)
3. 폴더 읽기 권한이 있는지
4. 충분한 디스크 공간이 있는지

그래도 안 되면 관리자 권한으로 실행

---

## 🎓 팁 & 트릭

### **Tip 1: 타임스탬프 활용**

파일명에 날짜/시간이 자동 포함됨.

```
baseline_case001_20250115_103045.txt
                 ↑        ↑
                날짜      시간
```

나중에 "언제 만든 베이스라인인지" 바로 알 수 있음.

---

### **Tip 2: 폴더명이 파일명에 포함**

```
baseline_case001_20250115.txt  ← case001 폴더용
baseline_case002_20250115.txt  ← case002 폴더용
```

여러 사건을 동시에 처리할 때 헷갈리지 않음.

---

### **Tip 3: 빠른 재검증**

최신 베이스라인을 바로 사용하려면:

```bash
python forensic_hash_tool.py --auto C:\evidence\case001
```

선택 메뉴 없이 바로 검증.

---

### **Tip 4: 주기적 검증 스케줄러**

Windows 작업 스케줄러나 cron으로 자동화 가능:

```bash
# 매일 오전 9시에 자동 검증
python forensic_hash_tool.py --auto C:\important\files
```

---

### **Tip 5: 리포트 파일 관리**

검증할 때마다 새 리포트 생성:

```
integrity_report_20250115_100000.txt  ← 1차 검증
integrity_report_20250118_140000.txt  ← 2차 검증
integrity_report_20250120_090000.txt  ← 3차 검증
```

변경 추이를 시간순으로 추적 가능.

---
